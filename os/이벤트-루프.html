<!DOCTYPE html> <html><head>
		<title>이벤트 루프</title>
		<base href="../">
		<meta id="root-path" root-path="../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="my_study - 이벤트 루프">
		<meta property="og:title" content="이벤트 루프">
		<meta property="og:description" content="my_study - 이벤트 루프">
		<meta property="og:type" content="website">
		<meta property="og:url" content="os/이벤트-루프.html">
		<meta property="og:image" content="https://my-study.s3.ap-northeast-2.amazonaws.com/%EC%9D%B4%EB%B2%A4%ED%8A%B8%20%EB%A3%A8%ED%94%84%20/%20Pasted%20image%2020240110152152.png">
		<meta property="og:site_name" content="my_study">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/supported-plugins.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript><link rel="preload" href="lib/styles/snippets.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/snippets.css"></noscript></head><body class="publish css-settings-manager theme-light show-inline-title show-ribbon code-styler code-styler-style-inline code-styler-gutter-highlight"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles">mjx-mfrac{display:inline-block;text-align:left}mjx-frac{display:inline-block;vertical-align:.17em;padding:0 .22em}mjx-frac[type="d"]{vertical-align:.04em}mjx-frac[delims]{padding:0 .1em}mjx-frac[atop]{padding:0 .12em}mjx-frac[atop][delims]{padding:0}mjx-dtable{display:inline-table;width:100%}mjx-dtable>*{font-size:2000%}mjx-dbox{display:block;font-size:5%}mjx-num{display:block;text-align:center}mjx-den{display:block;text-align:center}mjx-mfrac[bevelled]>mjx-num{display:inline-block}mjx-mfrac[bevelled]>mjx-den{display:inline-block}mjx-den[align=right],mjx-num[align=right]{text-align:right}mjx-den[align=left],mjx-num[align=left]{text-align:left}mjx-nstrut{display:inline-block;height:.054em;width:0;vertical-align:-.054em}mjx-nstrut[type="d"]{height:.217em;vertical-align:-.217em}mjx-dstrut{display:inline-block;height:.505em;width:0}mjx-dstrut[type="d"]{height:.726em}mjx-line{display:block;box-sizing:border-box;min-height:1px;height:.06em;border-top:.06em solid;margin:.06em -.1em;overflow:hidden}mjx-line[type="d"]{margin:.18em -.1em}mjx-mrow{display:inline-block;text-align:left}mjx-mspace{display:inline-block;text-align:left}mjx-c.mjx-c30::before{padding:.666em .5em .022em 0;content:"0"}mjx-c.mjx-c32::before{padding:.666em .5em 0 0;content:"2"}mjx-c.mjx-c34::before{padding:.677em .5em 0 0;content:"4"}mjx-c.mjx-c37::before{padding:.676em .5em .022em 0;content:"7"}mjx-c.mjx-c33::before{padding:.665em .5em .022em 0;content:"3"}mjx-c.mjx-c36::before{padding:.666em .5em .022em 0;content:"6"}mjx-c.mjx-c1D463.TEX-I::before{padding:.443em .485em .011em 0;content:"v"}mjx-c.mjx-c1D45F.TEX-I::before{padding:.442em .451em .011em 0;content:"r"}mjx-c.mjx-c1D44E.TEX-I::before{padding:.441em .529em .01em 0;content:"a"}mjx-c.mjx-c1D454.TEX-I::before{padding:.442em .477em .205em 0;content:"g"}mjx-c.mjx-c1D460.TEX-I::before{padding:.442em .469em .01em 0;content:"s"}mjx-c.mjx-c1D45C.TEX-I::before{padding:.441em .485em .011em 0;content:"o"}mjx-c.mjx-c1D45B.TEX-I::before{padding:.442em .6em .011em 0;content:"n"}mjx-c.mjx-c1D447.TEX-I::before{padding:.677em .704em 0 0;content:"T"}mjx-c.mjx-c35::before{padding:.666em .5em .022em 0;content:"5"}mjx-c.mjx-c2E::before{padding:.12em .278em 0 0;content:"."}mjx-msub{display:inline-block;text-align:left}mjx-c.mjx-c1D436.TEX-I::before{padding:.705em .76em .022em 0;content:"C"}mjx-c.mjx-c1D434.TEX-I::before{padding:.716em .75em 0 0;content:"A"}mjx-c.mjx-c1D449.TEX-I::before{padding:.683em .769em .022em 0;content:"V"}mjx-c.mjx-c1D445.TEX-I::before{padding:.683em .759em .021em 0;content:"R"}mjx-c.mjx-c1D443.TEX-I::before{padding:.683em .751em 0 0;content:"P"}mjx-c.mjx-c1D456.TEX-I::before{padding:.661em .345em .011em 0;content:"i"}mjx-container[jax=CHTML]{line-height:0}mjx-container [space="1"]{margin-left:.111em}mjx-container [space="2"]{margin-left:.167em}mjx-container [space="3"]{margin-left:.222em}mjx-container [space="4"]{margin-left:.278em}mjx-container [space="5"]{margin-left:.333em}mjx-container [rspace="1"]{margin-right:.111em}mjx-container [rspace="2"]{margin-right:.167em}mjx-container [rspace="3"]{margin-right:.222em}mjx-container [rspace="4"]{margin-right:.278em}mjx-container [rspace="5"]{margin-right:.333em}mjx-container [size="s"]{font-size:70.7%}mjx-container [size=ss]{font-size:50%}mjx-container [size=Tn]{font-size:60%}mjx-container [size=sm]{font-size:85%}mjx-container [size=lg]{font-size:120%}mjx-container [size=Lg]{font-size:144%}mjx-container [size=LG]{font-size:173%}mjx-container [size=hg]{font-size:207%}mjx-container [size=HG]{font-size:249%}mjx-container [width=full]{width:100%}mjx-box{display:inline-block}mjx-block{display:block}mjx-itable{display:inline-table}mjx-row{display:table-row}mjx-row>*{display:table-cell}mjx-mtext{display:inline-block;text-align:left}mjx-mstyle{display:inline-block}mjx-merror{display:inline-block;color:red;background-color:#ff0}mjx-mphantom{visibility:hidden}mjx-assistive-mml{top:0;left:0;clip:rect(1px,1px,1px,1px);user-select:none;position:absolute!important;padding:1px 0 0!important;border:0!important;display:block!important;width:auto!important;overflow:hidden!important}mjx-assistive-mml[display=block]{width:100%!important}mjx-math{display:inline-block;text-align:left;line-height:0;text-indent:0;font-style:normal;font-weight:400;font-size:100%;letter-spacing:normal;border-collapse:collapse;overflow-wrap:normal;word-spacing:normal;white-space:nowrap;direction:ltr;padding:1px 0}mjx-container[jax=CHTML][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=CHTML][display=true][width=full]{display:flex}mjx-container[jax=CHTML][display=true] mjx-math{padding:0}mjx-container[jax=CHTML][justify=left]{text-align:left}mjx-container[jax=CHTML][justify=right]{text-align:right}mjx-c{display:inline-block}mjx-utext{display:inline-block;padding:.75em 0 .2em}mjx-mo{display:inline-block;text-align:left}mjx-stretchy-h{display:inline-table;width:100%}mjx-stretchy-h>*{display:table-cell;width:0}mjx-stretchy-h>*>mjx-c{display:inline-block;transform:scaleX(1)}mjx-stretchy-h>*>mjx-c::before{display:inline-block;width:initial}mjx-stretchy-h>mjx-ext{overflow:clip visible;width:100%}mjx-stretchy-h>mjx-ext>mjx-c::before{transform:scaleX(500)}mjx-stretchy-h>mjx-ext>mjx-c{width:0}mjx-stretchy-h>mjx-beg>mjx-c{margin-right:-.1em}mjx-stretchy-h>mjx-end>mjx-c{margin-left:-.1em}mjx-stretchy-v{display:inline-block}mjx-stretchy-v>*{display:block}mjx-stretchy-v>mjx-beg{height:0}mjx-stretchy-v>mjx-end>mjx-c{display:block}mjx-stretchy-v>*>mjx-c{transform:scaleY(1);transform-origin:left center;overflow:hidden}mjx-stretchy-v>mjx-ext{display:block;height:100%;box-sizing:border-box;border:0 solid transparent;overflow:visible clip}mjx-stretchy-v>mjx-ext>mjx-c::before{width:initial;box-sizing:border-box}mjx-stretchy-v>mjx-ext>mjx-c{transform:scaleY(500) translateY(.075em);overflow:visible}mjx-mark{display:inline-block;height:0}mjx-mi{display:inline-block;text-align:left}mjx-mn{display:inline-block;text-align:left}mjx-msup{display:inline-block;text-align:left}mjx-texatom{display:inline-block;text-align:left}mjx-c::before{display:block;width:0}.MJX-TEX{font-family:MJXZERO,MJXTEX}.TEX-B{font-family:MJXZERO,MJXTEX-B}.TEX-I{font-family:MJXZERO,MJXTEX-I}.TEX-MI{font-family:MJXZERO,MJXTEX-MI}.TEX-BI{font-family:MJXZERO,MJXTEX-BI}.TEX-S1{font-family:MJXZERO,MJXTEX-S1}.TEX-S2{font-family:MJXZERO,MJXTEX-S2}.TEX-S3{font-family:MJXZERO,MJXTEX-S3}.TEX-S4{font-family:MJXZERO,MJXTEX-S4}.TEX-A{font-family:MJXZERO,MJXTEX-A}.TEX-C{font-family:MJXZERO,MJXTEX-C}.TEX-CB{font-family:MJXZERO,MJXTEX-CB}.TEX-FR{font-family:MJXZERO,MJXTEX-FR}.TEX-FRB{font-family:MJXZERO,MJXTEX-FRB}.TEX-SS{font-family:MJXZERO,MJXTEX-SS}.TEX-SSB{font-family:MJXZERO,MJXTEX-SSB}.TEX-SSI{font-family:MJXZERO,MJXTEX-SSI}.TEX-SC{font-family:MJXZERO,MJXTEX-SC}.TEX-T{font-family:MJXZERO,MJXTEX-T}.TEX-V{font-family:MJXZERO,MJXTEX-V}.TEX-VB{font-family:MJXZERO,MJXTEX-VB}mjx-stretchy-h mjx-c,mjx-stretchy-v mjx-c{font-family:MJXZERO,MJXTEX-S1,MJXTEX-S4,MJXTEX,MJXTEX-A!important}@font-face{font-family:MJXZERO;src:url("lib/fonts/mathjax_zero.woff") format("woff")}@font-face{font-family:MJXTEX;src:url("lib/fonts/mathjax_main-regular.woff") format("woff")}@font-face{font-family:MJXTEX-B;src:url("lib/fonts/mathjax_main-bold.woff") format("woff")}@font-face{font-family:MJXTEX-I;src:url("lib/fonts/mathjax_math-italic.woff") format("woff")}@font-face{font-family:MJXTEX-MI;src:url("lib/fonts/mathjax_main-italic.woff") format("woff")}@font-face{font-family:MJXTEX-BI;src:url("lib/fonts/mathjax_math-bolditalic.woff") format("woff")}@font-face{font-family:MJXTEX-S1;src:url("lib/fonts/mathjax_size1-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S2;src:url("lib/fonts/mathjax_size2-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S3;src:url("lib/fonts/mathjax_size3-regular.woff") format("woff")}@font-face{font-family:MJXTEX-S4;src:url("lib/fonts/mathjax_size4-regular.woff") format("woff")}@font-face{font-family:MJXTEX-A;src:url("lib/fonts/mathjax_ams-regular.woff") format("woff")}@font-face{font-family:MJXTEX-C;src:url("lib/fonts/mathjax_calligraphic-regular.woff") format("woff")}@font-face{font-family:MJXTEX-CB;src:url("lib/fonts/mathjax_calligraphic-bold.woff") format("woff")}@font-face{font-family:MJXTEX-FR;src:url("lib/fonts/mathjax_fraktur-regular.woff") format("woff")}@font-face{font-family:MJXTEX-FRB;src:url("lib/fonts/mathjax_fraktur-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SS;src:url("lib/fonts/mathjax_sansserif-regular.woff") format("woff")}@font-face{font-family:MJXTEX-SSB;src:url("lib/fonts/mathjax_sansserif-bold.woff") format("woff")}@font-face{font-family:MJXTEX-SSI;src:url("lib/fonts/mathjax_sansserif-italic.woff") format("woff")}@font-face{font-family:MJXTEX-SC;src:url("lib/fonts/mathjax_script-regular.woff") format("woff")}@font-face{font-family:MJXTEX-T;src:url("lib/fonts/mathjax_typewriter-regular.woff") format("woff")}@font-face{font-family:MJXTEX-V;src:url("lib/fonts/mathjax_vector-regular.woff") format("woff")}@font-face{font-family:MJXTEX-VB;src:url("lib/fonts/mathjax_vector-bold.woff") format("woff")}mjx-c.mjx-c28::before{padding:.75em .389em .25em 0;content:"("}mjx-c.mjx-c1D45D.TEX-I::before{padding:.442em .503em .194em 0;content:"p"}mjx-c.mjx-c2212::before{padding:.583em .778em .082em 0;content:"−"}mjx-c.mjx-c31::before{padding:.666em .5em 0 0;content:"1"}mjx-c.mjx-c29::before{padding:.75em .389em .25em 0;content:")"}mjx-c.mjx-c2C::before{padding:.121em .278em .194em 0;content:","}mjx-c.mjx-c1D45E.TEX-I::before{padding:.442em .46em .194em 0;content:"q"}mjx-c.mjx-c1D452.TEX-I::before{padding:.442em .466em .011em 0;content:"e"}mjx-c.mjx-c1D451.TEX-I::before{padding:.694em .52em .01em 0;content:"d"}mjx-c.mjx-c1D441.TEX-I::before{padding:.683em .888em 0 0;content:"N"}mjx-c.mjx-c3D::before{padding:.583em .778em .082em 0;content:"="}mjx-c.mjx-c1D45A.TEX-I::before{padding:.442em .878em .011em 0;content:"m"}mjx-c.mjx-c1D450.TEX-I::before{padding:.442em .433em .011em 0;content:"c"}mjx-c.mjx-c6D::before{padding:.442em .833em 0 0;content:"m"}mjx-c.mjx-c6F::before{padding:.448em .5em .01em 0;content:"o"}mjx-c.mjx-c64::before{padding:.694em .556em .011em 0;content:"d"}mjx-c.mjx-c1D458.TEX-I::before{padding:.694em .521em .011em 0;content:"k"}mjx-c.mjx-c2B::before{padding:.583em .778em .082em 0;content:"+"}</style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="이벤트 루프"><p dir="auto">이벤트 루프</p></h1><div class="heading-wrapper"><h3 data-heading="출처" dir="auto" class="heading" id="출처"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>출처</h3><div class="heading-children"><div><ul dir="auto">
<li data-line="0" dir="auto"><a rel="noopener" class="external-link" href="https://mbinjamil.dev/writings/understanding-async-io/" target="_blank">https://mbinjamil.dev/writings/understanding-async-io/</a> (이벤트 루프란)</li>
<li data-line="1" dir="auto"><a rel="noopener" class="external-link" href="https://en.wikipedia.org/wiki/Event_loop" target="_blank">https://en.wikipedia.org/wiki/Event_loop</a></li>
<li data-line="2" dir="auto"><a rel="noopener" class="external-link" href="https://baeharam.netlify.app/posts/javascript/event-loop" target="_blank">https://baeharam.netlify.app/posts/javascript/event-loop</a> (js의 이벤트 루프)</li>
<li data-line="3" dir="auto"><a rel="noopener" class="external-link" href="https://man7.org/linux/man-pages/man7/epoll.7.html" target="_blank">https://man7.org/linux/man-pages/man7/epoll.7.html</a> (epoll)</li>
<li data-line="4" dir="auto"><a rel="noopener" class="external-link" href="https://github.com/delaemon/libuv-tutorial/blob/master/tcp-client.c" target="_blank">https://github.com/delaemon/libuv-tutorial/blob/master/tcp-client.c</a> (libuv server code example)</li>
<li data-line="5" dir="auto"><a rel="noopener" class="external-link" href="https://docs.libuv.org/en/stable/design.html" target="_blank">https://docs.libuv.org/en/stable/design.html</a> (uvloop)</li>
<li data-line="6" dir="auto"><a rel="noopener" class="external-link" href="https://www.freecodecamp.org/news/javascript-es6-promises-for-beginners-resolve-reject-and-chaining-explained/" target="_blank">https://www.freecodecamp.org/news/javascript-es6-promises-for-beginners-resolve-reject-and-chaining-explained/</a> (promise)</li>
<li data-line="7" dir="auto"><a rel="noopener" class="external-link" href="https://ko.javascript.info/promise-chaining" target="_blank">https://ko.javascript.info/promise-chaining</a> (프로미스 체인)</li>
</ul></div><div><hr dir="auto"></div></div></div><div class="heading-wrapper"><h3 data-heading="개요" dir="auto" class="heading" id="개요"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>개요</h3><div class="heading-children"><div><ul dir="auto">
<li data-line="0" dir="auto"><a data-href="#자바스크립트와 파이썬의 이상함" href="#자바스크립트와_파이썬의_이상함" class="internal-link" target="_self" rel="noopener">자바스크립트와 파이썬의 이상함</a></li>
<li data-line="1" dir="auto"><a data-href="#이벤트 루프" href="#이벤트_루프" class="internal-link" target="_self" rel="noopener">이벤트 루프</a></li>
<li data-line="2" dir="auto"><a data-href="#왜 이벤트 루프?" href="#왜_이벤트_루프?" class="internal-link" target="_self" rel="noopener">왜 이벤트 루프?</a></li>
<li data-line="3" dir="auto"><a data-href="#실전 압축 이벤트 루프" href="#실전_압축_이벤트_루프" class="internal-link" target="_self" rel="noopener">실전 압축 이벤트 루프</a></li>
<li data-line="4" dir="auto"><a data-href="#JS의 이벤트 루프" href="#JS의_이벤트_루프" class="internal-link" target="_self" rel="noopener">JS의 이벤트 루프</a></li>
<li data-line="5" dir="auto"><a data-href="#libuv" href="#libuv" class="internal-link" target="_self" rel="noopener">libuv</a></li>
<li data-line="6" dir="auto"><a data-href="#Handle and Request" href="#Handle_and_Request" class="internal-link" target="_self" rel="noopener">Handle and Request</a></li>
<li data-line="7" dir="auto"><a data-href="#libuv 써먹어보기" href="#libuv_써먹어보기" class="internal-link" target="_self" rel="noopener">libuv 써먹어보기</a></li>
<li data-line="8" dir="auto"><a data-href="#콜백 지옥 벗어나기" href="#콜백_지옥_벗어나기" class="internal-link" target="_self" rel="noopener">콜백 지옥 벗어나기</a></li>
</ul></div><div><hr dir="auto"></div></div></div><div class="heading-wrapper"><h3 data-heading="자바스크립트와 파이썬의 이상함" dir="auto" class="heading" id="자바스크립트와_파이썬의_이상함"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>자바스크립트와 파이썬의 이상함</h3><div class="heading-children"><div><p dir="auto">자바스크립트와 파이썬은 대표적인 싱글 쓰레드 언어이다. <strong>싱글 쓰레드라 함은 한번에 처리하는 명령어가 한개라는 뜻으로</strong> 콜 스택에서 한개의 함수를 실행하고 함수 내부에 존재하는 <strong>명령어를 한개 씩 실행하는 방식으로 동작한다.</strong> 따라서 <span class="red red-bg"><b>어떠한 명령어가 아직 실행중이라면 다른 명령어는 실행될 수 없다.</b></span></p></div><div><pre dir="auto" class="language-python" tabindex="0"><code class="language-python is-loaded"><span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> random

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">do_something</span><span class="token punctuation">(</span>i<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sec <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> Wait for </span><span class="token interpolation"><span class="token punctuation">{</span>sec<span class="token punctuation">}</span></span><span class="token string">..."</span></span><span class="token punctuation">)</span>  <span class="token comment"># random wait...</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>sec<span class="token punctuation">)</span>  <span class="token comment"># 이 부분에서 멈춰야 한다!</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string"> waiting done"</span></span><span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    tasks <span class="token operator">=</span> <span class="token punctuation">[</span>asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>do_something<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks<span class="token punctuation">)</span> <span class="token comment">#wait for end...</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">하지만 위의 코드를 실행하면 <strong>대기를 진행하는 코드인 sleep이 실행 중임에도 다음 코드 들이 이어서 실행된다.</strong> 심지어 sleep이 완료되면 다시 이전의 실행 위치로 돌아와 함수를 마저 실행하고 종료되는 형태로 동작한다. <b><u>싱글 쓰레드에서 이러한 동작은 귀신 쓰레드가 sleep의 완료를 대기하고 메인 쓰레드는 이후 코드를 실행하는 것 처럼 보여 위화감을 불러 일으킨다.</u></b> 또한 대기가 발생하던 지점으로 어떻게 돌아오는지도 고민을 해봐야 한다. </p></div><div><ul dir="auto">
<li data-line="0" dir="auto"><strong>대기는 누가 어떻게 하는 거지?</strong></li>
<li data-line="1" dir="auto"><strong>어떻게 대기 완료 후 실행 흐름이 돌아오는 거지?</strong></li>
</ul></div><div><hr dir="auto"></div></div></div><div class="heading-wrapper"><h3 data-heading="이벤트 루프" dir="auto" class="heading" id="이벤트_루프"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>이벤트 루프</h3><div class="heading-children"><div><p dir="auto">첫번째 질문인 대기는 누가 어떻게 하는 거지에 대해 생각해보자. 알림 스피커가 고장난 전자렌지를 사용한다 가정하면, 전자렌지가 전부 돌았는지를 확인 하려면 렌지 앞에서 불이 꺼질때까지 지켜보는 수 밖에 없다. </p></div><div><p dir="auto">그러다면 누군가 지켜봐야 하니까 아마 대기를 위한 별도의 쓰레드가 존재하고 이를 활용해 처리를 하는 것이 분명한 것 같다. 따라서 <strong>JS와 파이썬은 선량한 개발자를 우롱하는 싱글 쓰레드인 척하는 언어이고 실상은 멀티 쓰레딩이 가능하다는 진실을 우리는 밝혀냈다!</strong> 귀도 반 로섬을 당장 고소해도 승소할 자신감이 생기는 시점이다.</p></div><div><p dir="auto">안타깝게도 이걸 통해 소송을 걸 경우 우리가 패소할 확률이 100%이다. 왜냐하면 <span class="red red-bg"><b>실제로 싱글 쓰레드 언어인 것이 맞고 이벤트 루프를 통해 마치 멀티 쓰레드인 것 처럼 동작 시키기 때문이다.</b></span> </p></div><div><p dir="auto">이제 이벤트 루프가 무엇인지 알아보자. <mark><strong>이벤트 루프는 하나의 구조 혹은 디자인 패턴으로 프로그램의 메시지나 이벤트를 대기하고<a data-tooltip-position="top" aria-label="시스템 콜 > Context Switching" data-href="시스템 콜#Context Switching" href="os/시스템-콜.html#Context_Switching" class="internal-link" target="_self" rel="noopener">디스패칭</a>하는 작업을 진행한다.  (이벤트를 대기하다가 처리부로 스위칭)</strong></mark><br>
이벤트 루프는 이벤트를 대기하다 이벤트가 발생할 경우 해당 이벤트의 핸들러를 호출해 이벤트가 적절히 처리되게 해준다. 이벤트 루프는 파일(fd) 인터페이스 기반으로 작성된 경우가 많으며 이때 <a data-tooltip-position="top" aria-label="IO Multiplexing" data-href="IO Multiplexing" href="os/io-multiplexing.html" class="internal-link" target="_self" rel="noopener">epoll, select</a>등의 시스템 콜을 활용해 이벤트 루프를 구성한다.</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout" dir="auto"><div class="callout-title" dir="auto"><div class="callout-icon" dir="auto"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner" dir="auto">Info</div></div><div class="callout-content" dir="auto">
<p dir="auto"><strong>이벤트 루프란 이벤트를 대기하고 적절히 처리 되게 하는 구조이다. 루프라는 이름이 붙은 이유는 이벤트가 발생하는지 반복해서 확인하고 처리해야 하기 떄문이다.</strong></p>
</div></div></div><div><hr dir="auto"></div></div></div><div class="heading-wrapper"><h3 data-heading="이벤트 루프의 동작 방식" dir="auto" class="heading" id="이벤트_루프의_동작_방식"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>이벤트 루프의 동작 방식</h3><div class="heading-children"><div><p dir="auto">그렇다면 이벤트루프는 어떻게 싱글 쓰레드에서 여러 개의 이벤트에 대응할 수 있게 처리할까? <strong>싱글 쓰레드에서 여러개의 IO를 처리하기 위한 방법은 앞서 언급한 select, epoll 등을 활용하는 것이다</strong>. 해당 방법들은 약간의 차이가 존재하지만, <strong><mark>공통적으로 관심있는 이벤트가 발생하는 fd를 등록하고 해당 fd를 지속적으로 모니터링해 이벤트 발생여부를 확인하는 방식으로 동작</mark>한다.</strong>  </p></div><div><p dir="auto">만약 10개의 소켓의 데이터 전송을 확인하고 싶으면 <b><u>각 소켓에서 이벤트가 발생 할 때까지 실행 흐름을 블락하는 것이 아니라, 여러 소켓을 잠깐씩 전부 순회하며 이벤트 발생 여부를 확인</u></b>하는 것이다. 이렇게하면 싱글 쓰레드에서도 여러개의 이벤트를 확인하고 관리하는 것이 가능해진다.</p></div><div><p dir="auto"><strong>이벤트 루프는 이러한 방식으로 관심있는 이벤트를 구독한 후 만약 이벤트가 발생할 경우 콜백을 호출해 이벤트의 적절한 처리를 다른 함수에 맡긴다.</strong> 따라서 이벤트 루프를 활용하면 적절한 Mutilplexing을 통해 싱글 쓰레드에서 병행적으로 이벤트를 감지하고 핸들링하는 것이 가능해진다.</p></div><div><pre dir="auto" class="language-sudo" tabindex="0"><code class="language-sudo is-loaded">function main
    initialize()
    while message != quit //루프 시작
        message = get_next_message() //이벤트를 감지한다. epoll,select 사용...
        process_message(message) //이벤트 처리 (콜백 등)
    end while
end function
</code><button class="copy-code-button">Copy</button></pre></div><div><hr dir="auto"></div></div></div><div class="heading-wrapper"><h3 data-heading="실전 압축 이벤트 루프" dir="auto" class="heading" id="실전_압축_이벤트_루프"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>실전 압축 이벤트 루프</h3><div class="heading-children"><div><p dir="auto">이벤트 루프를 활용해 이벤트를 감지하고 이를 적절히 처리하는 코드를 작성해보자. 아래 코드는 이전의 <a data-tooltip-position="top" aria-label="IO Multiplexing > epoll 써먹기" data-href="IO Multiplexing#epoll 써먹기" href="os/io-multiplexing.html#epoll_써먹기" class="internal-link" target="_self" rel="noopener">epoll</a>에서 사용한 코드로 이벤트 루프를 활용해 싱글 쓰레드에서 여러 소켓과 통신을 가능케 하는 구조이다.</p></div><div><pre dir="auto" class="language-c" tabindex="0"><code class="language-c is-loaded"><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 이벤트 루프의 시작</span>
	<span class="token keyword">int</span> numEvents <span class="token operator">=</span> <span class="token function">epoll_wait</span><span class="token punctuation">(</span>epollfd<span class="token punctuation">,</span> events<span class="token punctuation">,</span> MAX_EVENTS<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//이벤트가 발생할 때 까지 블락</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numEvents<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>events<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>fd <span class="token operator">==</span> serverSockfd<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//발생한 이벤트가 리스닝 소켓이면</span>
			<span class="token comment">// Accept a new connection</span>
			clientSockfd <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span>serverSockfd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">sockaddr</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>clientAddr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>clientAddrLen<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//연결 수립</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Accepted a new connection from %s:%d\n"</span><span class="token punctuation">,</span>
				   <span class="token function">inet_ntoa</span><span class="token punctuation">(</span>clientAddr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ntohs</span><span class="token punctuation">(</span>clientAddr<span class="token punctuation">.</span>sin_port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">// Initialize and add the new client to epoll</span>
			<span class="token function">initClient</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>clients<span class="token punctuation">[</span>clientSockfd<span class="token punctuation">]</span><span class="token punctuation">,</span> clientSockfd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//클라이언트 정보 설정</span>
			event<span class="token punctuation">.</span>events <span class="token operator">=</span> EPOLLIN<span class="token punctuation">;</span> <span class="token comment">//읽기 이벤트 </span>
			event<span class="token punctuation">.</span>data<span class="token punctuation">.</span>fd <span class="token operator">=</span> clientSockfd<span class="token punctuation">;</span> <span class="token comment">//수립한 클라이언트 커넥션</span>
			<span class="token function">epoll_ctl</span><span class="token punctuation">(</span>epollfd<span class="token punctuation">,</span> EPOLL_CTL_ADD<span class="token punctuation">,</span> clientSockfd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//이벤트 구독</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">// Receive data from an existing client</span>
			<span class="token function">receiveData</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>clients<span class="token punctuation">[</span>events<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>fd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//클라이언트에서 이벤트 발생시 </span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">반복적으로 이벤트의 발생 여부를 체크하고 이벤트가 발생한 fd에 따라 적절한 처리를 해주는 것을 확인할 수 있다. <mark><strong>복잡한 것이 이벤트 루프가 아니다. 이벤트의 발생 여부를 주기적으로 확인하고 이에 대한 적절한 처리를 해주는 구조를 이벤트 루프라 부른다.</strong></mark></p></div><div><hr dir="auto"></div></div></div><div class="heading-wrapper"><h3 data-heading="JS의 이벤트 루프" dir="auto" class="heading" id="JS의_이벤트_루프"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>JS의 이벤트 루프</h3><div class="heading-children"><div><p dir="auto">이벤트 루프에 대한 설명글을 찾아보면 대부분이 전부 JS를 예시로 들기 때문에 이벤트 루프를 좁게 정의하게 되는 경향이 존재한다. 하지만 착각하지 말자 JS의 이벤트 루프는 이벤트 루프중 하나일 뿐이다. </p></div><div><p dir="auto"><img src="https://my-study.s3.ap-northeast-2.amazonaws.com/%EC%9D%B4%EB%B2%A4%ED%8A%B8%20%EB%A3%A8%ED%94%84%20/%20Pasted%20image%2020240110152152.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">위는 자바스크립트에서 사용하는 이벤트 루프의 예시이다. 우측은 <strong>JS가 아닌 WebAPI에서 처리해주는 요소들을 말하며 비동기 처리되는 함수들이 전부 여기에 위치</strong>한다. <strong>setTimeout같은 함수는 JS엔진이 아닌 브라우저 단에서 처리를 해주며 이는 엔진과 별개로 동작하기 때문에 엔진의 쓰레드를 사용하지 않는다.</strong></p></div><div><p dir="auto">setTimeout이 완료되면 이는 콜백 큐로 이동하게 된다. 콜백 큐는 비동기 처리 작업이 완료된 함수들이 위치한 곳으로 여기에 있는 <strong>콜백 함수들은 콜 스택이 비었을 경우 콜 스택으로 이동 되고 실행</strong>된다. 이벤트 루프가 해당 작업을 담당하며 루프는 이를 처리하기 위해 콜백 큐와 스택을 항상 감시한다.</p></div><div><p dir="auto"><strong>JS의 이벤트 루프는 이벤트의 발생까지 감지 하지는 않고 발생한 이벤트 들의 적절한 처리를 도와주는 이벤트 디스패칭 기능이 특화돼 있다고 보여진다.</strong> </p></div><div><hr dir="auto"></div></div></div><div class="heading-wrapper"><h3 data-heading="libuv" dir="auto" class="heading" id="libuv"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>libuv</h3><div class="heading-children"><div><p dir="auto">libuv는 Node.js를 위해 작성된 이벤트 기반의 비동기 처리 라이브러리이다. 이는 <strong>크로스 플랫폼을 지원하며 각 OS 환경마다 다르게 존재하는 비동기 라이브러리를 전부 한번에 모은 후 최적화해 어느 곳에서나 쉽게 이벤트 기반의 비동기 처리를 가능하게 한다.</strong></p></div><div><p dir="auto"><img src="https://my-study.s3.ap-northeast-2.amazonaws.com/%EC%9D%B4%EB%B2%A4%ED%8A%B8%20%EB%A3%A8%ED%94%84%20/%20Pasted%20image%2020240115160611.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">libuv는 파일을 제외한 네트워크 연결에 대해서는 IO 멀티 플렉싱을 지원한다. 파일이나 DNS의 경우는 별도의 쓰레드 풀을 운영해 처리한다.</p></div><div><p dir="auto">libuv는 이벤트 루프 구조를 활용해 동작한다. 이때 사용하는 폴링 알고리즘은 각 OS 별로 가장 적합한 폴링 알고리즘을 사용한다. (epoll, kqueue...) 이외 싱글 쓰레드의 논 블락킹 소켓을 통해 동작하는 매커니즘 자체는 일반적인 비동기-논블락킹 패턴과 동일하다.</p></div><div><p dir="auto"><img src="https://my-study.s3.ap-northeast-2.amazonaws.com/%EC%9D%B4%EB%B2%A4%ED%8A%B8%20%EB%A3%A8%ED%94%84%20/%20Pasted%20image%2020240115161637.png" referrerpolicy="no-referrer"></p></div><div><p dir="auto">libuv의 동작 순서는 단순하다. 정말 간략하게 요약하면 아래와 같다.</p></div><div><ol dir="auto">
<li data-line="0" dir="auto">시간을 업데이트 한다.</li>
<li data-line="1" dir="auto">루프가 살아있을 경우 이전에 실행하지 못한 콜백을 실행한다.</li>
<li data-line="2" dir="auto">이벤트 발생으로 인해 트리거된 콜백들을 실행한다.</li>
<li data-line="3" dir="auto">이벤트를 대기한다.</li>
<li data-line="4" dir="auto">구독 해지시 처리해야할 콜백을 처리한다.</li>
<li data-line="5" dir="auto">시간을 업데이트 한다.</li>
</ol></div><div><hr dir="auto"></div></div></div><div class="heading-wrapper"><h3 data-heading="Handle and Request" dir="auto" class="heading" id="Handle_and_Request"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Handle and Request</h3><div class="heading-children"><div><p dir="auto"><strong>libuv는 크로스-플랫폼을 지원하는 만큼 추상화가 필수적인데, 핸들과 리퀘스트를 사용해 추상화를 진행한다.</strong> 핸들은 루프에 오랫동안 머무는 fd와 같은 등록하는 요소를 의미하고 리퀘스트는 핸들에서 발생한 한번의 IO 이벤트를 말한다. 리퀘스트는 콜백을 통해 사용되며 루프 내부에서 짧게 머문다.</p></div><div><p dir="auto"><strong>즉, 핸들은 주기적으로 이벤트를 확인하는 요소이고 리퀘스트는 해당 핸들에서 발생한 이벤트라고 정의할 수 있다.</strong></p></div><div><p dir="auto"><strong>핸들의 대표적인 예시로는 Stream Handle가 존재하며 tcp, pipe, tty 핸들이 이를 상속받아 구현된다</strong>. <a data-tooltip-position="top" aria-label="https://docs.libuv.org/en/stable/stream.html" rel="noopener" class="external-link" href="https://docs.libuv.org/en/stable/stream.html" target="_blank">실제 API</a>를 살펴보면 더 직관적으로 와 닿는데 Stream 핸들에는 다음과 같은 요소들이 존재한다.</p></div><div><ul dir="auto">
<li data-line="0" dir="auto">
<p dir="auto"><strong>uv_listen</strong><br>
연결을 듣는 작업을 루프에 등록하는 함수로 서버 소켓과 연결 수립시 처리할 콜백을 인자로 받는다. 이 함수를 통해 루프에서 계속해서 listen 이벤트를 확인하며 이벤트 발생시 콜백을 실행해준다.</p>
</li>
<li data-line="3" dir="auto">
<p dir="auto"><strong>uv_accept</strong><br>
연결을 수립하는 작업을 수행한다. <strong>listen 함수의 콜백 내부에서 사용해야만 하는 함수</strong> 이다. 해당 함수는 한 커넥션 당 한번만 호출할 수 있다.</p>
</li>
<li data-line="6" dir="auto">
<p dir="auto"><strong>uv_read_start</strong><br>
읽기 이벤트를 감지할 핸들과 이벤트 발생시 호출할 콜백을 인자로 받는다. 읽기 이벤트를 루프에 등록해 읽을 것이 생기면 콜백을 호출한다.</p>
</li>
</ul></div><div><p dir="auto">Stream 핸들은 커넥션을 사용하는 여러 프로토콜에서 공통적으로 사용하는 API들을 구현해놨다. 각 프로토콜 별 요소들은 Stream 핸들을 상속 받은 각 핸들 내부에 추가적으로 구현돼 있다.</p></div><div><p dir="auto"><b><u>리퀘스트는 위의 API를 사용하며 등록한 콜백에 전달되는 매개변수로 해당 핸들에서 발생한 IO 이벤트 정보를 갖고 있다.</u></b> 핸들을 통해 데이터를 작성하거나 내보내고 싶다면 리퀘스트를 활용 해야만한다. 리퀘스트는 비동기 IO를 처리하기 위한 자료구조이다. </p></div><div><hr dir="auto"></div></div></div><div class="heading-wrapper"><h3 data-heading="libuv 써먹어보기" dir="auto" class="heading" id="libuv_써먹어보기"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>libuv 써먹어보기</h3><div class="heading-children"><div><p dir="auto">이벤트 루프를 libuv를 사용해 작성해 사용해보자. 직접 만든 이벤트 루프와 비교하면서 한번 살펴보자. 아래는 간단하게 작성한 TCP Echo Server이다.</p></div><div><pre dir="auto" class="language-c" tabindex="0"><code class="language-c is-loaded"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;uv.h&gt;</span></span>

<span class="token class-name">uv_loop_t</span> <span class="token operator">*</span>loop<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">sockaddr_in</span> addr<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">alloc_buffer</span><span class="token punctuation">(</span><span class="token class-name">uv_handle_t</span> <span class="token operator">*</span>handle<span class="token punctuation">,</span> <span class="token class-name">size_t</span> suggested_size<span class="token punctuation">,</span> <span class="token class-name">uv_buf_t</span> <span class="token operator">*</span>buf<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//버퍼를 할당한다.</span>
    buf<span class="token operator">-&gt;</span>base <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>suggested_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    buf<span class="token operator">-&gt;</span>len <span class="token operator">=</span> suggested_size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">echo_write</span><span class="token punctuation">(</span><span class="token class-name">uv_write_t</span> <span class="token operator">*</span>req<span class="token punctuation">,</span> <span class="token keyword">int</span> status<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//write 작성 이후에 콜백으로 오류 검출 등의 작업을 진행한다.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>status<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"Write error %s\n"</span><span class="token punctuation">,</span> <span class="token function">uv_strerror</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">free</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">echo_read</span><span class="token punctuation">(</span><span class="token class-name">uv_stream_t</span> <span class="token operator">*</span>client<span class="token punctuation">,</span> <span class="token class-name">ssize_t</span> nread<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">uv_buf_t</span> <span class="token operator">*</span>buf<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">// 읽기 작업 이후 실행되는 콜백</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nread <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nread <span class="token operator">!=</span> UV_EOF<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
	        <span class="token comment">//연결 종료시</span>
            <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"Read error %s\n"</span><span class="token punctuation">,</span> <span class="token function">uv_err_name</span><span class="token punctuation">(</span>nread<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">uv_close</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uv_handle_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>client<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 핸들을 루프에서 제거한다.</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nread <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">uv_write_t</span> <span class="token operator">*</span>req <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uv_write_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uv_write_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 쓰기용 리퀘스트 객체 생성</span>
        <span class="token class-name">uv_buf_t</span> wrbuf <span class="token operator">=</span> <span class="token function">uv_buf_init</span><span class="token punctuation">(</span>buf<span class="token operator">-&gt;</span>base<span class="token punctuation">,</span> nread<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// 쓰기용 버퍼 생성</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buffer: %s\n"</span><span class="token punctuation">,</span> buf<span class="token operator">-&gt;</span>base<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">uv_write</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> client<span class="token punctuation">,</span> <span class="token operator">&amp;</span>wrbuf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> echo_write<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 버퍼에 내용 작성</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>buf<span class="token operator">-&gt;</span>base<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">free</span><span class="token punctuation">(</span>buf<span class="token operator">-&gt;</span>base<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">on_new_connection</span><span class="token punctuation">(</span><span class="token class-name">uv_stream_t</span> <span class="token operator">*</span>server<span class="token punctuation">,</span> <span class="token keyword">int</span> status<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"New connection error %s\n"</span><span class="token punctuation">,</span> <span class="token function">uv_strerror</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">uv_tcp_t</span> <span class="token operator">*</span>client <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uv_tcp_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uv_tcp_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">uv_tcp_init</span><span class="token punctuation">(</span>loop<span class="token punctuation">,</span> client<span class="token punctuation">)</span><span class="token punctuation">;</span>                         <span class="token comment">// 클라이언트 용 tcp 소켓 초기화</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">uv_accept</span><span class="token punctuation">(</span>server<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">uv_stream_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>client<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 서버 소켓의 커넥션 클라이언트에 할당</span>
    <span class="token punctuation">{</span>
        <span class="token function">uv_read_start</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uv_stream_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>client<span class="token punctuation">,</span> alloc_buffer<span class="token punctuation">,</span> echo_read<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 연결된 커넥션에서 데이터를 읽는 이벤트를 등록한다. 이벤트가 발생할 때 마다 콜백을 실행한다.</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        <span class="token function">uv_close</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uv_handle_t</span> <span class="token operator">*</span><span class="token punctuation">)</span>client<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//연결 실패시</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    loop <span class="token operator">=</span> <span class="token function">uv_default_loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">uv_tcp_t</span> server<span class="token punctuation">;</span>
    <span class="token function">uv_tcp_init</span><span class="token punctuation">(</span>loop<span class="token punctuation">,</span> <span class="token operator">&amp;</span>server<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// tcp 소켓 초기화</span>

    <span class="token function">uv_ip4_addr</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">7000</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>addr<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">uv_tcp_bind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>server<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">sockaddr</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>addr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 바인딩</span>
    <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token function">uv_listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">uv_stream_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>server<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> on_new_connection<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 리스닝 작업 등록, 리스닝 이벤트 발생시 on_new_connection 콜백 실행</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>r<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"Listen error %s\n"</span><span class="token punctuation">,</span> <span class="token function">uv_strerror</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">uv_run</span><span class="token punctuation">(</span>loop<span class="token punctuation">,</span> UV_RUN_DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">서버 코드를 보면 기존과 가장 크게 느껴지는 점은 반복문이 제거됐다는 점이다. 현재 <strong>코드는 반복문 없이 루프에 이벤트를 등록하고 콜백을 활용해 처리하는 구조를 띄고 있다.</strong> 다만 모든 함수들이 콜백의 방식으로 처리되기 때문에 코드의 흐름이 한눈에 들어오진 않아 <strong>디버깅에 어려움이 존재</strong>한다.</p></div><div><pre dir="auto" class="language-c" tabindex="0"><code class="language-c is-loaded"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;uv.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">doEcho</span><span class="token punctuation">(</span><span class="token class-name">uv_stream_t</span> <span class="token operator">*</span>tcp<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">alloc_buffer</span><span class="token punctuation">(</span><span class="token class-name">uv_handle_t</span> <span class="token operator">*</span>handle<span class="token punctuation">,</span> <span class="token class-name">size_t</span> suggested_size<span class="token punctuation">,</span> <span class="token class-name">uv_buf_t</span> <span class="token operator">*</span>buf<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    buf<span class="token operator">-&gt;</span>base <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>suggested_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    buf<span class="token operator">-&gt;</span>len <span class="token operator">=</span> suggested_size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">echo_read</span><span class="token punctuation">(</span><span class="token class-name">uv_stream_t</span> <span class="token operator">*</span>server<span class="token punctuation">,</span> <span class="token class-name">ssize_t</span> nread<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">uv_buf_t</span> <span class="token operator">*</span>buf<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nread <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"error echo_read"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"result: %s\n"</span><span class="token punctuation">,</span> buf<span class="token operator">-&gt;</span>base<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//에코 메시지 출력</span>
    <span class="token function">doEcho</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//다시 에코 실행</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">on_write_end</span><span class="token punctuation">(</span><span class="token class-name">uv_write_t</span> <span class="token operator">*</span>req<span class="token punctuation">,</span> <span class="token keyword">int</span> status<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"error on_write_end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
        <span class="token function">uv_read_start</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>handle<span class="token punctuation">,</span> alloc_buffer<span class="token punctuation">,</span> echo_read<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 메시지 읽는 이벤트 등록</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">doEcho</span><span class="token punctuation">(</span><span class="token class-name">uv_stream_t</span> <span class="token operator">*</span>tcp<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> buffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> message<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name">uv_buf_t</span> buf <span class="token operator">=</span> <span class="token function">uv_buf_init</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//while을 쓸 수 없다...</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"input: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//메시지 작성</span>

    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    buf<span class="token punctuation">.</span>len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    buf<span class="token punctuation">.</span>base <span class="token operator">=</span> message<span class="token punctuation">;</span>

    <span class="token class-name">uv_write_t</span> write_req<span class="token punctuation">;</span>
    <span class="token keyword">int</span> buf_count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">uv_write</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>write_req<span class="token punctuation">,</span> tcp<span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> buf_count<span class="token punctuation">,</span> on_write_end<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//메시지 전송 이벤트 등록</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">on_connect</span><span class="token punctuation">(</span><span class="token class-name">uv_connect_t</span> <span class="token operator">*</span>req<span class="token punctuation">,</span> <span class="token keyword">int</span> status<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//연결 수립시 진행하는 콜백</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"error on_write_end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Connection Success\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">doEcho</span><span class="token punctuation">(</span>req<span class="token operator">-&gt;</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 에코 함수 호출, 이벤트가 발생한 핸들을 넘겨준다.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">uv_loop_t</span> <span class="token operator">*</span>loop <span class="token operator">=</span> <span class="token function">uv_default_loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">uv_tcp_t</span> <span class="token operator">*</span>socket <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uv_tcp_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uv_tcp_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">uv_tcp_init</span><span class="token punctuation">(</span>loop<span class="token punctuation">,</span> socket<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">uv_connect_t</span> <span class="token operator">*</span>connect <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">uv_connect_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">uv_connect_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">sockaddr_in</span> dest<span class="token punctuation">;</span>
    <span class="token function">uv_ip4_addr</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">7000</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">uv_tcp_connect</span><span class="token punctuation">(</span>connect<span class="token punctuation">,</span> socket<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">sockaddr</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>dest<span class="token punctuation">,</span> on_connect<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//서버와 연결 이벤트 등록</span>

    <span class="token function">uv_run</span><span class="token punctuation">(</span>loop<span class="token punctuation">,</span> UV_RUN_DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 루프 실행</span>
<span class="token punctuation">}</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">클라이언트 코드는 반복문 없이 함수끼리 순환하는 구조로 작성해 메시지를 반복해 보내고 있다. <b><u>반복문을 활용하면 곤란한 상황에 빠지기 때문인데 무한 루프 while을 doEcho 함수에서 활용할 경우 루프가 쓰레드를 할당 받지 못하면서 영영 while문에서만 코드가 실행되는 상황이 발생하기 때문이다.</u></b></p></div><div><p dir="auto"><span class="red red-bg"><b>이에 따라 루프의 흐름을 막지 않는 형태로 콜백을 통해서 순환고리를 만드는 방식으로 코드를 작성할 수 밖에 없다. </b></span> on_connect -&gt; doEcho -&gt; on_write_end -&gt; echo_read -&gt; doEcho</p></div><div><p dir="auto">문제는 이러한 방식으로 코드를 작성하면 코드의 흐름을 알아채기도 어렵고 디버깅도 어려워진다. 또한 <mark><strong>콜백에서 콜백을 호출하고 또 콜백을 호출하는 콜백 지옥에 빠질 가능성이 존재하기 때문에 이를 개선할 필요가 존재한다.</strong></mark></p></div><div><hr dir="auto"></div></div></div><div class="heading-wrapper"><h3 data-heading="콜백 지옥 벗어나기" dir="auto" class="heading" id="콜백_지옥_벗어나기"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>콜백 지옥 벗어나기</h3><div class="heading-children"><div><p dir="auto">위와 같이 콜백에 콜백을 물리는 구조에서 벗어날 수 없는 이유는 조건을 보장할 수 없기 때문이다. 어떠한 이벤트가 발생했을 때 발생하는 것이 콜백인데, 콜백이 아닌 다른 방식으로 함수를 호출하기 위해선 인위적으로 이벤트가 발생했다는 것을 감지해줘야 한다. 대표적으로 아래와 같은 방식을 사용해 볼 수 있다.</p></div><div><pre dir="auto" class="language-python" tabindex="0"><code class="language-python is-loaded"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> is_event<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		do_something<span class="token punctuation">(</span><span class="token punctuation">)</span>
	
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">이러한 방식을 활용하면 콜백을 활용하지 않고 함수를 호출할 수 있지만, 비지 웨이팅이라는 문제점이 발생한다. <span class="red red-bg"><b>이에 따라 비지웨이팅 하지 않고 함수를 블락 했다가 원하는 이벤트가 발생했을 때 다시 돌아오는 구조에 대한 요구가 커져갔는데 이를 만족하기 위해 등장한 것이 async/await이다.</b></span></p></div><div><hr dir="auto"></div></div></div><div class="heading-wrapper"><h3 data-heading="Promise 잠깐만" dir="auto" class="heading" id="Promise_잠깐만"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Promise 잠깐만</h3><div class="heading-children"><div><p dir="auto">async/await 에 대해 이야기하기전에 우선 Promise 객체에 대해 설명할 필요가 있다. <span class="red red-bg"><b>Promise는 JS에서 사용하는 비동기 처리를 위한 객체로 콜백 지옥으로부터 탈출해보자는 용도로 개발됐다.</b></span> 프로미스는 아래와 같이 생겼다.</p></div><div><pre dir="auto" class="language-js" tabindex="0"><code class="language-js is-loaded"><span class="token keyword">let</span> promise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">do_something</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//executor</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">"완료"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"…"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 무시됨</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">

**프로미스를 생성하면 내부에 등록한 실행할 함수는 자동적으로 실행되고 성공적으로 함수가 실행되면 resolve를 통해 전달 받은 콜백을 호출하고 실패 시 reject를 통해 전달 받은 콜백을 호출한다.** 

프로미스 객체는 프로세스와 동일하게 상태를 가진다. 처음 생성했을때 pending 상태이며 이는 아직 비동기 작업이 완료되지 않은 상태를 말한다. resolved는 비동기 작업이 정상적으로 완료된 경우를 의미하고 rejected 같은 경우는 작업중 오류가 발생한 상태를 말한다.

프로미스는 반드시 resolve 되거나 reject 돼야하고 이러한 프로미스들은 settled 프로미스라고 한다. 이는 pending 상태의 프로미스와 반대 개념으로 처리가 완료된 프로미스를 말한다.

![](https://my-study.s3.ap-northeast-2.amazonaws.com/%EC%9D%B4%EB%B2%A4%ED%8A%B8%20%EB%A3%A8%ED%94%84%20/%20Pasted%20image%2020240120225523.png)

프로미스 객체의 비동기 작업이 완료되고 나면 후속 작업을 진행해야 하는데 이를 위해선 then이나 catch 같은 메서드를 사용해야 한다.

**then**
then을 사용하면 프로미스 객체를 처리하고 난 뒤 결과 데이터를 활용하는 콜백 함수를 등록한다. 이후 반환 값으로 해당 콜백의 결과를 전달한다. **이때 반환하는 객체 역시 Promise 객체로 then이 프로미스의 동작 완료를 보장해주진 않는다.**
</span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span>js
promise<span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 결과(result)를 다룹니다 */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* 에러(error)를 다룹니다 */</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto">then 역시 프로미스의 동작 완료를 보장해주진 못하기 때문에 만약 비동기 작업에서 순서를 보장해 동작하기 위해선 프로미스 체이닝 같은 기법을 활용해야 한다.</p></div><div class="heading-wrapper"><h4 data-heading="프로미스 체인" dir="auto" class="heading" id="프로미스_체인"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>프로미스 체인</h4><div class="heading-children"><div><pre dir="auto" class="language-js" tabindex="0"><code class="language-js is-loaded"><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// (*)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// (**)</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
  <span class="token keyword control-flow">return</span> result <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// (***)</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
  <span class="token keyword control-flow">return</span> result <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
  <span class="token keyword control-flow">return</span> result <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button">Copy</button></pre></div><div><p dir="auto"><b><u>우리는 앞선 프로미스 객체의 비동기 동작이 완료 됐다는 것을 보장할 수 없기 때문에 결국에 또 다시 콜백을 활용해 순서를 보장 해야만 한다.</u></b> 이를 위해서 프로미스 후에 콜백을 등록하고 후에 다시 콜백을 등록하고 후에 다시 콜백을 등록하는 콜백 지옥에 또다시 빠지게 된다.</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="info" class="callout" dir="auto"><div class="callout-title" dir="auto"><div class="callout-icon" dir="auto"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg></div><div class="callout-title-inner" dir="auto">Info</div></div><div class="callout-content" dir="auto">
<p dir="auto"><strong>지옥을 벗어나기 위해선 다른 방법이 필요하고 이를 위해 고안된 것이 async/await이다.</strong></p>
</div></div></div><div><hr dir="auto"></div><div class="mod-footer"></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="os/이벤트-루프.html#이벤트 루프"><div class="tree-item-contents heading-link" heading-name="이벤트 루프"><span class="tree-item-title">이벤트 루프</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="os/이벤트-루프.html#출처"><div class="tree-item-contents heading-link" heading-name="출처"><span class="tree-item-title">출처</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="os/이벤트-루프.html#개요"><div class="tree-item-contents heading-link" heading-name="개요"><span class="tree-item-title">개요</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="os/이벤트-루프.html#자바스크립트와_파이썬의_이상함"><div class="tree-item-contents heading-link" heading-name="자바스크립트와 파이썬의 이상함"><span class="tree-item-title">자바스크립트와 파이썬의 이상함</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="os/이벤트-루프.html#이벤트_루프"><div class="tree-item-contents heading-link" heading-name="이벤트 루프"><span class="tree-item-title">이벤트 루프</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="os/이벤트-루프.html#이벤트_루프의_동작_방식"><div class="tree-item-contents heading-link" heading-name="이벤트 루프의 동작 방식"><span class="tree-item-title">이벤트 루프의 동작 방식</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="os/이벤트-루프.html#실전_압축_이벤트_루프"><div class="tree-item-contents heading-link" heading-name="실전 압축 이벤트 루프"><span class="tree-item-title">실전 압축 이벤트 루프</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="os/이벤트-루프.html#JS의_이벤트_루프"><div class="tree-item-contents heading-link" heading-name="JS의 이벤트 루프"><span class="tree-item-title">JS의 이벤트 루프</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="os/이벤트-루프.html#libuv"><div class="tree-item-contents heading-link" heading-name="libuv"><span class="tree-item-title">libuv</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="os/이벤트-루프.html#Handle_and_Request"><div class="tree-item-contents heading-link" heading-name="Handle and Request"><span class="tree-item-title">Handle and Request</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="os/이벤트-루프.html#libuv_써먹어보기"><div class="tree-item-contents heading-link" heading-name="libuv 써먹어보기"><span class="tree-item-title">libuv 써먹어보기</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="os/이벤트-루프.html#콜백_지옥_벗어나기"><div class="tree-item-contents heading-link" heading-name="콜백 지옥 벗어나기"><span class="tree-item-title">콜백 지옥 벗어나기</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="os/이벤트-루프.html#Promise_잠깐만"><div class="tree-item-contents heading-link" heading-name="Promise 잠깐만"><span class="tree-item-title">Promise 잠깐만</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="os/이벤트-루프.html#프로미스_체인"><div class="tree-item-contents heading-link" heading-name="프로미스 체인"><span class="tree-item-title">프로미스 체인</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>